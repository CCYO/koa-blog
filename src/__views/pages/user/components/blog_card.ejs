<% let G_DATA = JSON.parse(--CONS.SERVER.BLOG--) %>
<% let G_PAGE = JSON.parse(--CONS.PAGE.USER--) %>
<% for(let status in blogs){ %>
<% let isPublic = status === G_DATA.STATUS.PUBLIC %>
<% if(!isSelf && !isPublic){ continue }%>
<% let blogData = blogs[status] %>

<div class="blogList card bg-light" data-<%= G_PAGE.DATASET.KEY.BLOG_STATUS %>="<%= status %>">
  <div class="card-header align-items-center">
    <h5><%= isPublic ? '公開的BLOG' : '編輯中的BLOG' %></h5>
    <% if(isSelf && blogData.count) { %>
    <button type="button" class="btn btn-sm btn-outline-danger" data-<%= G_PAGE.DATASET.KEY.REMOVE_BLOG %>="<%= G_PAGE.DATASET.VALUE.REMOVE_BLOG_LIST %>">全部刪除</button>
    <% } %>
  </div>
  <% if(blogData.count){ %>
  <ul>
    <% let page = 1 %>
    <% let blogs = blogData.blogs %>
    <%- ejs_template.blog_list({ blogs, page, isSelf, isPublic }) %>
  </ul>
  <% if (blogData.count / pagination.BLOG_COUNT > 1) { %>
  <nav aria-label="...">
    <ul class="pagination">
      <li class="page-item">
        <a class="page-link pe-none" href="#" data-<%= G_PAGE.DATASET.KEY.PAGE_TURN %>="<%= G_PAGE.DATASET.VALUE.PREVIOUS_PAGINATION %>">
          << </a>
      </li>
      <li class="page-item">
        <a class="page-link pe-none" href="#" data-<%= G_PAGE.DATASET.KEY.PAGE_TURN %>="<%= G_PAGE.DATASET.VALUE.PREVIOUS_PAGE %>">Previous</a>
      </li>
      <% var totalPage=Math.ceil(blogData.count / pagination.BLOG_COUNT) %>
      <% for(let page_num=1; totalPage>= page_num; page_num++){ %>
      <% if((page_num % pagination.PAGE_COUNT)===1){ %>
      <!-- 除5若無餘數，要有ul li -->
      <ul class="pagination" data-<%= G_PAGE.DATASET.KEY.PAGINATION_NUM %>="<%= Math.ceil(page_num / pagination.PAGE_COUNT) %>" <% if(Math.ceil(page_num / pagination.PAGE_COUNT) > 1){ %> style="display: none;" <% } %>>
        <% } %>
        <!-- 除5無論有無餘數，都要li -->
        <li class="page-item <%= page_num === 1 ? 'active' : '' %>">
          <a class="page-link" href="#" data-<%= G_PAGE.DATASET.KEY.PAGE_TURN %>="<%= page_num %>">
            <%= page_num %>
          </a>
        </li>
        <% if( !(page_num % pagination.PAGE_COUNT) || page_num===totalPage ){ %>
      </ul>
      <% } %>
      <% } %>
      <li class="page-item">
        <a href="#" data-<%= G_PAGE.DATASET.KEY.PAGE_TURN %>="<%= G_PAGE.DATASET.VALUE.NEXT_PAGE %>" class="page-link <%= totalPage < 2 ? "pe-none" : '' %>">Next</a>
      </li>
      <li class="page-item">
        <a href="#" data-<%= G_PAGE.DATASET.KEY.PAGE_TURN %>="<%= G_PAGE.DATASET.VALUE.NEXT_PAGINATION %>" class="page-link <%= totalPage <= 2 ? "pe-none" : '' %>"> >> </a>
      </li>
    </ul>
  </nav>
  <% } %>

  <% } else { %>
  <p class="p-3">沒有<%= isPublic ? '公開' : '編輯中' %>的BLOG
  </p>
  <% } %>
</div>

<% } %>