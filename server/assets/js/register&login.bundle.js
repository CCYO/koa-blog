(self.webpackChunk=self.webpackChunk||[]).push([[66],{22717:e=>{var n={VALIDATE:{USER_ERRNO:123456,USER:function(e){return{errno:n.VALIDATE.USER_ERRNO,msg:e}}},CACHE:{UPDATE:{NO_DATA:function(e){return{errno:50002,msg:"更新 cache/".concat(e," 卻沒提供參數")}}},READ:{NO_DATA:function(e){return{errno:50002,msg:"撈取 cache/".concat(e," 卻沒提供參數")}}}},MSG_RECEIVER:{UPDATE:{ERR:{errno:801,msg:"更新 MsgReceiver 失敗"},CONFIRM:{errno:1003,msg:"confirm msgReceiver 失敗"},ROW:{errno:1401,msg:"bulkCreate MsgReceiver 的數量不完全"}},DELETE:{ROW:{errno:40003,msg:"刪除 MsgReceiver 的數量不完全"},ERR:{errno:801,msg:"刪除 MsgReceiver 失敗"}},CREATE:{ROW:{errno:40005,msg:"創建 MsgReceiver 的數量不完全"},NO_DATA:{errno:50002,msg:"創建 MsgReceiver 卻沒提供參數"},ERR:{errno:50001,msg:"MsgReceiver 創建失敗"}},READ:{SHOULD_NOT_EXIST:{errno:50003,msg:"出現不該存在的 MsgReceiver"},NOT_EXIST:{errno:50003,msg:"不存在任何相符的 MsgReceiver"}}},ARTICLE_READER:{UPDATE:{ERR:{errno:801,msg:"更新 ArticleReader 失敗"},CONFIRM:{errno:1003,msg:"confirm articleReader 失敗"},ROW:{errno:10004,msg:" ArticleReader 更新結果的數量不完全"}},DELETE:{ERR:{errno:801,msg:"刪除 ArticleReader 失敗"},ROW:{errno:40003,msg:"刪除 ArticleReader 的數量不完全"}},CREATE:{NO_DATA:{errno:50002,msg:"創建 ArticleReader 卻沒提供參數"},ROW:{errno:40005,msg:"創建 ArticleReader 的數量不完全"},ERR:{errno:40005,msg:"ArticleReader 創建失敗"}},RESTORE:{ROW:{errno:40004,msg:"恢復軟刪除 ArticleReader 的數量不完全"}}},IDOL_FANS:{CREATE:{ROW:{errno:40001,msg:"IdolFans 創建數量不完全"}},UPDATE:{CONFIRM:{errno:1003,msg:"confirm IdolFans 失敗"},ERR:{errno:801,msg:"更新 IdolFans 失敗"}},RESTORE:{ROW:{errno:40004,msg:"恢復軟刪除 IdolFans 的數量不完全"}},DELETE:{ERR:{errno:801,msg:"刪除 IdolFans 失敗"},ROW:{errno:40003,msg:"刪除 IdolFans 的數量不完全"},NO_IDOL:{errno:40002,msg:"要刪除的 Idol 不存在"}}},COMMENT:{DELETE:{NOT_DATA:{errno:50002,msg:"刪除 COMMENT 卻沒提供參數"},ERR:{errno:801,msg:"刪除 COMMENT 失敗"},ROW:{errno:40003,msg:"刪除 BLOG 的數量不完全"}},READ:{NOT_EXIST:{errno:50003,msg:"不存在任何相符的 Comment"}},CREATE_ERR:{errno:1103,msg:"COMMENT 創建失敗"},NOT_EXIST:{errno:1102,msg:"評論不存在"},REMOVE_ERR:{errno:1101,msg:"文章刪除失敗"}},BLOG_IMG_ALT:{UPDATE:{errno:902,msg:"BLOG_IMG_ALT 更新失敗"},READ:{NO_DATA:{errno:50002,msg:"查詢 BLOG_IMG_ALT 卻沒提供參數"},NOT_EXIST:{errno:50003,msg:"不存在任何相符的 BlogImgAlt"}},DELETE:{ERR:{errno:801,msg:"刪除 BlogImgAlt 失敗"},ROW:{errno:40003,msg:"刪除 BlogImgAlt 的數量不完全"}},CREATE:{NO_DATA:{errno:50002,msg:"創建 BLOG_IMG_ALT 卻沒提供參數"},ERR:{errno:50001,msg:"BlogImgAlt創建失敗"}},REMOVE_ERR:{errno:903,msg:"BlogImgAlt刪除失敗"}},BLOG:{DELETE:{ROW:{errno:40003,msg:"刪除 BLOG 的數量不完全"},ERR:{errno:801,msg:"刪除 BLOG 失敗"}},REMOVE:{NO_DATA:{errno:30001,msg:"刪除 BLOG 卻沒提供查詢參數"},ERR:{errno:706,msg:"刪除Blog失敗"}},UPDATE:{errno:30004,msg:"BLOG資料更新失敗"},CREATE:{errno:30003,msg:"BLOG 創建失敗"},READ:{NOT_EXIST:{errno:30002,msg:"BLOG不存在"},NO_DATA:{errno:30001,msg:"查詢 BLOG 卻沒提供查詢參數"}},UPLOAD_IMG_ERR:{errno:704,msg:"Blog內文圖片上傳失敗"},IMAGE_REMOVE_ERR:{errno:705,msg:"刪除BlogImg時，數量對不上"}},BLOG_IMG:{READ:{NOT_EXIST:{errno:1111,msg:"沒有相符的 BlogImg"}},CREATE:{NO_DATA:{errno:50002,msg:"創建 BLOG_IMG 卻沒提供參數"},ERR:{errno:50001,msg:"BlogImg創建失敗"}},DELETE:{ERR:{errno:801,msg:"刪除 BlogImg 失敗"},ROW:{errno:40003,msg:"刪除 BlogImg 的數量不完全"}},UPDATE_ERR:{errno:802,msg:"更新失敗"},CREATE_ERR:{errno:803,msg:"創建失敗"}},IMG:{CREATE:{NO_DATA:{errno:50002,msg:"創建 IMG 卻沒提供參數"},ERR:{errno:50001,msg:"IMG 創建失敗"}},NO_DATA:{errno:40001,msg:"沒有相符的 IMG"}},PERMISSION:{NOT_OWNER:{errno:200002,msg:"非擁有者"},NO_LOGIN:{errno:111111,msg:"尚未登入"},NOT_SELF:{errno:502,msg:"非本人"}},USER:{READ:{FIRST_FOLLOW:{errno:12003,msg:"第一次跟隨此 idol，沒有軟刪除 idolFans 紀錄"},NO_USER:{errno:12002,msg:"找不到 USER"},NO_DATA:{errno:12001,msg:"USER 無相關數據"}},LOGIN:{NO_USER:{errno:11002,msg:"查無此人，email或password有誤"},DATA_INCOMPLETE:{errno:11001,msg:"未提供email或password"}},REGISTER:{CREATE:{errno:10004,msg:"USER 創建失敗"},NO_PASSWORD:{errno:10003,msg:"密碼未填"},NO_EMAIL:{errno:10002,msg:"信箱未填"},IS_EXIST:{errno:10001,msg:"此信箱已被登記"}}},NEWS:{FOLLOW_CONFIRM_ERR:{errno:1101,msg:"Follow.confirm 更新失敗"},BLOG_FANS_CONFIRM_ERR:{errno:1102,msg:"Blog_Fans.confirm 更新失敗"},FOLLOW_COMMENT_CONFIRM_ERR:{errno:1103,msg:"Blog_Fans.confirm 更新失敗"}},READ:{NOT_EXIST:{errno:201,msg:"沒有相符的使用者資料"}},UPDATE:{NO_DATA:{errno:333,msg:"更新 User Data 卻沒提供數據"},INVALICATE:{errno:301},UNEXPECTED:{errno:399},VALICATE_ERR:{errno:302},NO_THIS_ONE:{errno:303,msg:"沒有這個人"},AVATAR_FORMAT_ERR:{errno:304,msg:"avatar圖檔格式錯誤，只接受JPG或PNG"},NO_EXT:{errno:305,msg:"少了ext數據"},NO_HASH:{errno:305,msg:"少了hash數據"},FORMIDABLE_ERR:{errno:306,msg:"formidable 解析發生錯誤"},UPDATE_GCE_ERR:{errno:307,msg:"upload file to GCS 發生錯誤"}},FORMAT_ERR:{errno:601},PUB_SUB:{REMOVE_ERR:{errno:1101,msg:"PUB_SUB 刪除失敗"}},SERVER_ERR:{errno:9999,msg:"伺服器錯誤"}};e.exports=n},2779:(e,n,r)=>{"use strict";r.a(e,(async(e,n)=>{try{var t=r(74846),a=r.n(t),o=r(68270),s=r.n(o),i=r(44315),c=r.n(i),l=r(17876),u=r.n(l),d=r(90837),f=r.n(d),m=r(59129),p=r(86806),g=r(66584),v=r.n(g),h=r(23598),w=r.n(h),E=r(2729),R=r.n(E),y=r(69845),b=r.n(y),A=r(70846),x=r.n(A),O=r(31295),I=r.n(O),T=r(64473),_=r(760),L=r(67874),S=r(17533),D=r(24439),k=r(16864),M=r(30018),N=r(65638);function P(e,n){var r=void 0!==c()&&u()(e)||e["@@iterator"];if(!r){if(f()(e)||(r=G(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(i)throw o}}}}function G(e,n){var r;if(e){if("string"==typeof e)return U(e,n);var t=a()(r=Object.prototype.toString.call(e)).call(r,8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?s()(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?U(e,n):void 0}}function U(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}var $=(0,T.T)(),Z=$.loadEnd,C=$.loading;try{C(),console.log("loading start -----");var j=new D.Z;await j.addOtherInitFn(M.Z),await j.addOtherInitFn(k.Z),await j.render(F),Z()}catch(B){throw B}function F(){var e=L.Z,n={login:{},register:{}},r=(0,_.Z)((function(e){return o.apply(this,arguments)})),t=(0,_.Z)(s({FORM:"register",API:"/api/user/register"})),a=(0,_.Z)(s({FORM:"login",API:"/api/user"}));function o(){return(o=(0,p.Z)(v().mark((function r(t){var a,o,s,c,l,u,d;return v().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=t.target,o=N(a).parents("form")[0],s=o.dataset.myType,c=n[s],l=a.value,c.email=l,r.next=8,e.email(c);case 8:if(!(u=r.sent)){r.next=13;break}return d=u.email,i(a,!1,d),r.abrupt("return");case 13:i(a,!0,""),a.focus();case 15:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function s(r){return function(){var t=(0,p.Z)(v().mark((function t(o){var s,c,l,u,d,f,p,g,h,E,y,A,O,T,_,L,D,k,M,$,Z,C,j,G,U,F,B,V,W,q,X,H,J,K,z,Q,Y,ee,ne;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o.preventDefault(),s=o.target,c=r.FORM,l=r.API,u=document.querySelector("form[data-my-type=".concat(c,"]")),d=n[c],f=[],p=[],g=e[c],"input"!==o.type){t.next=13;break}d[s.name]=s.value,t.next=32;break;case 13:h=P(u),t.prev=14,h.s();case 16:if((E=h.n()).done){t.next=24;break}if(y=E.value,console.log("@inp => ",y),"submit"!==y.type&&("register"!==c||"email"!==y.name)){t.next=21;break}return t.abrupt("continue",22);case 21:d[y.name]=y.value;case 22:t.next=16;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(14),h.e(t.t0);case 29:return t.prev=29,h.f(),t.finish(29);case 32:return t.next=34,g(d);case 34:if(A=t.sent,"input"!==o.type){t.next=57;break}O=P(u),t.prev=37,O.s();case 39:if((T=O.n()).done){t.next=47;break}if(_=T.value,L=_.name,"submit"!==_.type&&("register"!==c||"email"!==L)){t.next=44;break}return t.abrupt("continue",45);case 44:A&&A[L]?A[L]&&f.push({inp:_,msg:A[L]}):p.push(_);case 45:t.next=39;break;case 47:t.next=52;break;case 49:t.prev=49,t.t1=t.catch(37),O.e(t.t1);case 52:return t.prev=52,O.f(),t.finish(52);case 55:t.next=72;break;case 57:if(!A){t.next=65;break}for(Z in M=w()(D=R()(k=(0,m.Z)(u)).call(k,(function(e){return"submit"!==e.type&&!("register"===c&&"email"===e.name)}))).call(D,(function(e){return e.name})),$=new(b())(M),A)$.delete(Z),j=x()(C=N(u)).call(C,"input[name=".concat(Z,"]"))[0],f.push({inp:j,msg:A[Z]});G=P($);try{for(G.s();!(U=G.n()).done;)B=U.value,V=x()(F=N(u)).call(F,"input[name=".concat(B,"]"))[0],p.push(V)}catch(e){G.e(e)}finally{G.f()}t.next=72;break;case 65:return t.next=67,S.Z.post(l,d);case 67:return W=t.sent,q=W.errno,X=W.msg,q?(alert(X),N(u)[0].reset(),d={},i(!1)):"login"===c?(alert("登入成功"),H=!!location.search&&new(I())(location.search).get("from"),location.href=H||"/self"):(alert("註冊成功，請嘗試登入"),location.pathname="/login"),t.abrupt("return");case 72:for(J=0,K=p;J<K.length;J++)i(K[J],!0,"");for(z=0,Q=f;z<Q.length;z++)Y=Q[z],ee=Y.inp,ne=Y.msg,i(ee,!1,ne),ee.removeEventListener("input",a),ee.addEventListener("input",a);return t.abrupt("return");case 75:case"end":return t.stop()}}),t,null,[[14,26,29,32],[37,49,52,55]])})));function a(e){return t.apply(this,arguments)}return a}()}function i(e,n,r){if(!1===e){var t,a=P(N("form"));try{for(a.s();!(t=a.n()).done;){var o,s=P(t.value);try{for(s.s();!(o=s.n()).done;){var i=o.value;N(i).removeClass("is-invalid is-valid"),N(i).next().removeClass("invalid-feedback valid-feedback myshow").text("")}}catch(e){s.e(e)}finally{s.f()}}}catch(e){a.e(e)}finally{a.f()}}else"load"===n?N(e).next().toggleClass("my-show",!0).text("loading..."):n?(N(e).removeClass("is-invalid").addClass("is-valid"),N(e).next().removeClass("invalid-feedback myshow").addClass("valid-feedback").text(r)):(N(e).removeClass("is-valid").addClass("is-invalid"),N(e).next().removeClass("valid-feedback myshow").addClass("invalid-feedback").text(r))}N("form[data-my-type=register] input[name=email]").on("input",r),N("form[data-my-type=register]").on("submit",t),N("form[data-my-type=login]").on("submit",a)}n()}catch(V){n(V)}}),1)},17533:(e,n,r)=>{"use strict";r.d(n,{Z:()=>p});var t=r(23356),a=r.n(t),o=r(10414),s=r.n(o),i=r(14206),c=r.n(i),l=r(64473),u=r(22717);console.log("@_axios loading.....");var d=(0,l.T)(),f=d.loading,m=d.loadEnd;c().interceptors.request.use((function(e){return f(),e}),(function(e){throw e})),c().interceptors.response.use((function(e){e.config.url;var n=e.data,r=n.errno,t=(n.data,n.msg,e.data);return r===u.PERMISSION.NO_LOGIN.errno&&(t={errno:r,data:{me:{}}}),m(),a().resolve(t)}),(function(e){return function(e){var n,r,t=e.response.data,o=t.errno,i=t.msg;return n=o===u.PERMISSION.NO_LOGIN.errno?"/login?from=".concat(encodeURIComponent(location.href)):s()(r="/errPage?errno=".concat(encodeURIComponent(o),"&msg=")).call(r,encodeURIComponent(i)),alert(i),location.href=n,a().reject()}(e)}));const p=c()},64473:(e,n,r)=>{"use strict";r.d(n,{T:()=>h});var t=r(5007),a=r.n(t),o=r(74846),s=r.n(o),i=r(68270),c=r.n(i),l=r(44315),u=r.n(l),d=r(17876),f=r.n(d),m=r(90837),p=r.n(m),g=r(65638);function v(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function h(){var e=[];return{loading:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];g(".backdrop").removeClass("my-noshow"),g("*").on("keydown",n),g("body").css("pointer-events","none");var t,o=function(e,n){var r=void 0!==u()&&f()(e)||e["@@iterator"];if(!r){if(p()(e)||(r=function(e,n){var r;if(e){if("string"==typeof e)return v(e,n);var t=s()(r=Object.prototype.toString.call(e)).call(r,8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?c()(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?v(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}(g("input"));try{for(o.s();!(t=o.n()).done;){var i=t.value,l=g(i);l.prop("disabled")||(l.prop("disabled",!0),e.push(l))}}catch(e){o.e(e)}finally{o.f()}a()(r).call(r,(function(e){return e.disable()}))},loadEnd:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];g(".backdrop").addClass("my-noshow"),g("*").off("keydown",n),g("body").css("pointer-events","auto");for(var t=0,o=e;t<o.length;t++)o[t].prop("disabled",!1);e=[],a()(r).call(r,(function(e){return e.enable()}))}};function n(e){e.preventDefault()}}console.log("@commonUI loading...")},760:(e,n,r)=>{"use strict";r.d(n,{Z:()=>d});var t=r(86806),a=r(66584),o=r.n(a),s=r(66524),i=r.n(s),c=r(10414),l=r.n(c);console.log("@genDebounce loading...");var u={ms:250,auto:!1};function d(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u,a=r.ms,s=void 0===a?u.ms:a,c=r.auto,d=void 0===c?u.auto:c;return function r(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];n&&clearTimeout(n),n=i()((0,t.Z)(o().mark((function n(){var t;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.call.apply(e,l()(t=[this]).call(t,c));case 2:d&&r(e,s);case 3:case"end":return n.stop()}}),n,this)}))),s)}}},24439:(e,n,r)=>{"use strict";r.d(n,{Z:()=>O});var t=r(74846),a=r.n(t),o=r(68270),s=r.n(o),i=r(44315),c=r.n(i),l=r(17876),u=r.n(l),d=r(90837),f=r.n(d),m=r(86806),p=r(50623),g=r(1489),v=r(1005),h=r(23356),w=r.n(h),E=r(29089),R=r.n(E),y=r(66584),b=r.n(y);function A(e,n){var r=void 0!==c()&&u()(e)||e["@@iterator"];if(!r){if(f()(e)||(r=function(e,n){var r;if(e){if("string"==typeof e)return x(e,n);var t=a()(r=Object.prototype.toString.call(e)).call(r,8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?s()(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?x(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,d=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){d=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(d)throw i}}}}function x(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}console.log("@initData loading....");var O=function(){function e(){(0,p.Z)(this,e),(0,v.Z)(this,"data",{}),(0,v.Z)(this,"promises",[])}var n,r;return(0,g.Z)(e,[{key:"addOtherInitFn",value:(r=(0,m.Z)(b().mark((function e(n){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.promises.push(n());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"render",value:(n=(0,m.Z)(b().mark((function e(n){var r,t,a,o,s;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w().all(this.promises);case 2:r=e.sent,t=A(r),e.prev=4,t.s();case 6:if((a=t.n()).done){e.next=18;break}o=a.value,e.t0=R()(b()).call(b(),o);case 9:if((e.t1=e.t0()).done){e.next=16;break}if("news"!==(s=e.t1.value)){e.next=13;break}return e.abrupt("continue",9);case 13:this.data[s]=o[s],e.next=9;break;case 16:e.next=6;break;case 18:e.next=23;break;case 20:e.prev=20,e.t2=e.catch(4),t.e(e.t2);case 23:return e.prev=23,t.f(),e.finish(23);case 26:if(!n){e.next=29;break}return e.next=29,n(this.data);case 29:case"end":return e.stop()}}),e,this,[[4,20,23,26]])}))),function(e){return n.apply(this,arguments)})}]),e}()},30018:(e,n,r)=>{"use strict";r.d(n,{Z:()=>H});var t=r(91994),a=r.n(t),o=r(56908),s=r.n(o),i=r(2729),c=r.n(i),l=r(55125),u=r.n(l),d=r(59225),f=r.n(d),m=r(51313),p=r.n(m),g=r(86829),v=r.n(g),h=r(86828),w=r.n(h),E=r(54740),R=r.n(E),y=r(52532),b=r.n(y),A=r(90837),x=r.n(A),O=r(74846),I=r.n(O),T=r(81906),_=r(59129),L=r(47555),S=r(18018),D=r(1005),k=r(86806),M=r(66584),N=r.n(M),$=r(58837),Z=r.n($),C=r(64925),j=r.n(C),P=r(5007),G=r.n(P),U=r(10414),F=r.n(U),B=r(17533),V=r(65638);function W(){W=function(e,n){return new r(e,void 0,n)};var e=RegExp.prototype,n=new(w());function r(e,t,a){var o=new RegExp(e,t);return n.set(o,a||n.get(e)),(0,S.Z)(o,r.prototype)}function t(e,r){var t,o=n.get(r);return Z()(t=a()(o)).call(t,(function(n,r){var t=o[r];if("number"==typeof t)n[r]=e[t];else{for(var a=0;void 0===e[t[a]]&&a+1<t.length;)a++;n[r]=e[t[a]]}return n}),R()(null))}return(0,L.Z)(r,RegExp),r.prototype.exec=function(n){var r=e.exec.call(this,n);if(r){r.groups=t(r,this);var a=r.indices;a&&(a.groups=t(a,this))}return r},r.prototype[b()]=function(r,a){if("string"==typeof a){var o=n.get(this);return e[b()].call(this,r,a.replace(/\$<([^>]+)>/g,(function(e,n){var r=o[n];return"$"+(x()(r)?r.join("$"):r)})))}if("function"==typeof a){var s=this;return e[b()].call(this,r,(function(){var e=arguments;return"object"!=(0,T.Z)(e[e.length-1])&&(e=I()([]).call(e)).push(t(e,s)),a.apply(this,e)}))}return e[b()].call(this,r,a)},W.apply(this,arguments)}function q(e,n){var r=a()(e);if(s()){var t=s()(e);n&&(t=c()(t).call(t,(function(n){return u()(e,n).enumerable}))),r.push.apply(r,t)}return r}function X(e){for(var n=1;n<arguments.length;n++){var r,t,a=null!=arguments[n]?arguments[n]:{};n%2?G()(r=q(Object(a),!0)).call(r,(function(n){(0,D.Z)(e,n,a[n])})):f()?p()(e,f()(a)):G()(t=q(Object(a))).call(t,(function(n){v()(e,n,u()(a,n))}))}return e}function H(){return J.apply(this,arguments)}function J(){return J=(0,k.Z)(N().mark((function e(){var n,r,t,a,o,s;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(e){var n=new(j());return G()(e).call(e,(function(e){n.set(e.alt_id,X({},e))})),n},o=function(){return o=(0,k.Z)(N().mark((function e(n){var r,t,a,o,i,c,l,u,d,f;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f=function(e){return Z()(e).call(e,(function(e,n){var r=e.map_commentId,t=e.map_commentPid;return function e(n){var a,o=n.id,s=n.p_id,i=n.reply;r.set(o,n);var c=t.get(s)||[];return t.set(s,F()(a=[]).call(a,(0,_.Z)(c),[n])),i.length?G()(i).call(i,(function(n){return e(n)})):t.set(o,[]),{map_commentId:r,map_commentPid:t}}(n)}),{map_commentId:new(j()),map_commentPid:(new(j())).set(0,[])})},d=function(e){if(!e||"null"===e||"undefined"===e)return"";for(var n,t=decodeURI(e),a=W(/<x\x2Dimg.+?data\x2Dalt\x2Did='(\w+?)'.+?(data\x2Dstyle='(.+?)')?.*?\/>/g,{alt_id:1,style:3}),o=t;n=a.exec(t);){var s,i,c,l,u,d=n.groups,f=d.alt_id,m=d.style,p=r.map_imgs.get(1*f),g=p.url,v=p.alt,h=m?F()(s=F()(i=F()(c="<img src='".concat(g,"?alt_id=")).call(c,f,"' alt='")).call(i,v,"' style='")).call(s,m,"' />"):F()(l=F()(u="<img src='".concat(g,"?alt_id=")).call(u,f,"' alt='")).call(l,v,"' />");o=o.replace(n[0],h)}return o},(r=JSON.parse(n)).map_imgs=s(r.imgs),r.html=d(r.html),t=/^\/blog\/edit\/\d+/.test(location.pathname),a=/\?preview=true/.test(location.search),console.log("@isBlogEditPage 判斷是否為 編輯頁 => ",t),console.log("@isBlogPreview 判對是否為 預覽頁 => ",a),console.log("@若是編輯頁或預覽頁 => 不需請求 comment"),t||a){e.next=23;break}return e.next=15,B.Z.get("/api/comment/".concat(r.id));case 15:if(o=e.sent,i=o.errno,c=o.data,!i){e.next=21;break}return alert("ERR"),e.abrupt("return");case 21:l=c.comments,u=c.commentsHtmlStr,r=X(X({},r),{},{comments:l,commentsHtmlStr:u},f(l));case 23:return e.abrupt("return",r);case 24:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)},a=function(e){return o.apply(this,arguments)},t=function(e){var n=JSON.parse(e),r=n.blog,t=n.imgs;return{blog:r,imgs:t,map_imgs:s(t)}},n=[],V("[data-my-data]").each((function(e,r){return n.push(r)})),e.next=8,Z()(n).call(n,function(){var e=(0,k.Z)(N().mark((function e(n,r){var o,s,i,c;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=V(r).data("my-data"),e.prev=1,i=V(r).html(),"blog"!==o){e.next=10;break}return e.next=6,a(i);case 6:e.t0=e.sent,s={blog:e.t0},e.next=18;break;case 10:if("album"!==o){e.next=17;break}return e.next=13,t(i);case 13:e.t1=e.sent,s={album:e.t1},e.next=18;break;case 17:s=(0,D.Z)({},o,JSON.parse(i));case 18:return e.next=20,n;case 20:return c=e.sent,e.abrupt("return",X(X({},c),s));case 24:throw e.prev=24,e.t2=e.catch(1),e.t2;case 27:case"end":return e.stop()}}),e,null,[[1,24]])})));return function(n,r){return e.apply(this,arguments)}}(),{});case 8:return r=e.sent,V("[data-my-data]").parent().remove(),e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)}))),J.apply(this,arguments)}console.log("@initEJSData loading....")},16864:(e,n,r)=>{"use strict";r.d(n,{Z:()=>te});var t=r(68270),a=r.n(t),o=r(44315),s=r.n(o),i=r(17876),c=r.n(i),l=r(90837),u=r.n(l),d=r(91994),f=r.n(d),m=r(56908),p=r.n(m),g=r(2729),v=r.n(g),h=r(55125),w=r.n(h),E=r(5007),R=r.n(E),y=r(59225),b=r.n(y),A=r(51313),x=r.n(A),O=r(86829),I=r.n(O),T=r(86828),_=r.n(T),L=r(54740),S=r.n(L),D=r(52532),k=r.n(D),M=r(81906),N=r(47555),$=r(18018),Z=r(1005),C=r(59129),j=r(86806),P=r(66584),G=r.n(P),U=r(10414),F=r.n(U),B=r(58837),V=r.n(B),W=r(23598),q=r.n(W),X=r(74846),H=r.n(X),J=r(17533),K=r(760),z=r(65638);function Q(){Q=function(e,n){return new r(e,void 0,n)};var e=RegExp.prototype,n=new(_());function r(e,t,a){var o=new RegExp(e,t);return n.set(o,a||n.get(e)),(0,$.Z)(o,r.prototype)}function t(e,r){var t,a=n.get(r);return V()(t=f()(a)).call(t,(function(n,r){var t=a[r];if("number"==typeof t)n[r]=e[t];else{for(var o=0;void 0===e[t[o]]&&o+1<t.length;)o++;n[r]=e[t[o]]}return n}),S()(null))}return(0,N.Z)(r,RegExp),r.prototype.exec=function(n){var r=e.exec.call(this,n);if(r){r.groups=t(r,this);var a=r.indices;a&&(a.groups=t(a,this))}return r},r.prototype[k()]=function(r,a){if("string"==typeof a){var o=n.get(this);return e[k()].call(this,r,a.replace(/\$<([^>]+)>/g,(function(e,n){var r=o[n];return"$"+(u()(r)?r.join("$"):r)})))}if("function"==typeof a){var s=this;return e[k()].call(this,r,(function(){var e=arguments;return"object"!=(0,M.Z)(e[e.length-1])&&(e=H()([]).call(e)).push(t(e,s)),a.apply(this,e)}))}return e[k()].call(this,r,a)},Q.apply(this,arguments)}function Y(e,n){var r=f()(e);if(p()){var t=p()(e);n&&(t=v()(t).call(t,(function(n){return w()(e,n).enumerable}))),r.push.apply(r,t)}return r}function ee(e){for(var n=1;n<arguments.length;n++){var r,t,a=null!=arguments[n]?arguments[n]:{};n%2?R()(r=Y(Object(a),!0)).call(r,(function(n){(0,Z.Z)(e,n,a[n])})):b()?x()(e,b()(a)):R()(t=Y(Object(a))).call(t,(function(n){I()(e,n,w()(a,n))}))}return e}function ne(e,n){var r=void 0!==s()&&c()(e)||e["@@iterator"];if(!r){if(u()(e)||(r=function(e,n){var r;if(e){if("string"==typeof e)return re(e,n);var t=H()(r=Object.prototype.toString.call(e)).call(r,8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?a()(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?re(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,d=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){d=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(d)throw i}}}}function re(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function te(){return ae.apply(this,arguments)}function ae(){return ae=(0,j.Z)(G().mark((function e(){var n,r,t,a,o,s,i,c,l;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(){return(l=(0,j.Z)(G().mark((function e(n){return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.Z.post("/api/news",n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},c=function(e){return l.apply(this,arguments)},i=function(){var e=Q(/^\/(\w+)\/?(list)?/,{pathname:1,albumList:2}).exec(location.pathname).groups,n=e.pathname;e.albumList,console.log("@pathname => ",n),z('.nav-link[href^="/'.concat(n,'"]')).addClass("active")},s=function(){z(".navbar").removeClass("navbar-expand-sm").addClass("navbar-expand"),z(".nav").removeClass("order-0 order-md-0").addClass("order-1"),z(".offcanvas").removeClass("order-1 order-md-1").addClass("order-0"),z(".navbar-toggler, .offcanvas").remove()},o=function(e){var n=z("#readMore"),r=z("#noNews"),t=z(".news-count"),a=z("#newsDropdown"),o={me:e.me,news:{newsDropdownOpen:!1,readMoring:{_value:!1,get status(){return this._value},set status(e){this._value=e,n.children("button").prop("disabled",e)}},htmlStr:{confirm:"",unconfirm:""},newsList:{confirm:[],unconfirm:[]},excepts:{idolFans:[],articleReader:[],msgReceiver:[],get num(){return this.idolFans.length+this.articleReader.length+this.msgReceiver.length}},num:{newsList:{get unconfirm(){return u.unconfirm.length},get confirm(){return u.confirm.length},get total(){return this.confirm+this.unconfirm}},db:{confirm:0,unconfirm:0,total:0},unRender:{confirm:0,unconfirm:0,get total(){return this.confirm+this.unconfirm},clear:function(){this.confirm=0,this.unconfirm=0}},rendered:{confirm:0,unconfirm:0,get total(){return this.confirm+this.unconfirm},clear:function(){this.confirm=0,this.unconfirm=0}}},fn:{listTotal:function(e){return e.confirm.length+e.unconfirm.length},itemIsExist:function(e){return!!e.confirm||!!e.unconfirm},excepts:{clear:function(){for(var e in d)"num"!==e&&(d[e]=[])},update:function(e){var n,r=ne(e);try{for(r.s();!(n=r.n()).done;){var t=n.value,a=t.type,o=t.id;d[1===a?"idolFans":2===a?"articleReader":"msgReceiver"].push(o)}}catch(e){r.e(e)}finally{r.f()}}},newsList:{clear:function(){for(var e in u)u[e]=[];m.excepts.clear()},update:function(e){var n=e.newsList,r=e.num;if(f.db=r,m.listTotal(n))for(var t in n){var a,o=n[t];u[t]=F()(a=[]).call(a,(0,C.Z)(u[t]),(0,C.Z)(o)),m.excepts.update(o)}},reset:function(e){this.clear(),this.update(e)}},htmlStr:{_template:function(e){var n=this._gen,r=n.idolFans,t=n.articleReader,a=n.msgReceiver;return V()(e).call(e,(function(e,n){var o=n.type,s=n.confirm?'<li data-my-hr="confirm-news-hr">':'<li data-my-hr="unconfirm-news-hr">';return(e+=1===o?r(n):2===o?t(n):a(n))+(s+'<hr class="dropdown-divider"></li>')}),"")},_gen:{idolFans:function(e){var n,r,t,a=e.confirm,o=e.id,s=e.fans,i=e.timestamp,c=a?"":"?type=1&id=".concat(o);return F()(n=F()(r=F()(t='\n                                        \x3c!-- 新通知 of fans --\x3e\n                                        <li class="dropdown-item position-relative news-item">\n                                            <a href="/other/'.concat(s.id)).call(t,c,'" class="stretched-link text-wrap ">\n                                                <div>\n                                                    <span>')).call(r,s.nickname,"追蹤你囉！</span><br>\n                                                    <span class='text-end mb-0'>")).call(n,i,"</span>\n                                                </div>\n                                            </a>\n                                        </li>")},articleReader:function(e){var n,r,t,a,o=e.confirm,s=e.id,i=e.blog,c=e.timestamp,l=o?"":"?type=2&id=".concat(s);return F()(n=F()(r=F()(t=F()(a='\n                                        <li class="dropdown-item  position-relative news-item">\n                                            <a href="/blog/'.concat(i.id)).call(a,l,'" class="stretched-link text-wrap">\n                                                <div>\n                                                    <span>')).call(t,i.author.nickname," 有新文章唷！</span><br>\n                                                    <span>- ")).call(r,i.title,"-</span><br>\n                                                    <span class='text-end mb-0'>")).call(n,c,"</span>\n                                                </div>\n                                            </a>\n                                        </li>")},msgReceiver:function(e){var n,r,t,a,s,i,c,l=e.confirm,u=e.id,d=e.comment,f=e.timestamp,m=l?"":"?type=3&id=".concat(u),p=d.otherComments,g=p.commenters.length,v=q()(n=p.commenters).call(n,(function(e){return e.nickname})),h=d.commenter.nickname+g>1?H()(v).call(v,0,2).join(",")+(g>2?"與其他".concat(g-2,"人"):"，都"):1===g?v[0]:d.commenter.nickname,w=d.article.author.id===o.me.id?"你":d.article.author.id===d.commenter.id?"自己":d.blog.author.nickname;return F()(r=F()(t=F()(a=F()(s=F()(i=F()(c='\n                                        <li class="dropdown-item  position-relative news-item">\n                                            <a href="/blog/'.concat(d.article.id)).call(c,m,"#comment_")).call(i,d.id,'" class="stretched-link text-wrap">\n                                                <div>\n                                                    <span>')).call(s,h,"在")).call(a,w,"的文章「")).call(t,d.article.title,"」留言囉！</span><br>\n                                                    <span class='text-end mb-0'>")).call(r,f,"</span>\n                                                </div>\n                                            </a>\n                                        </li>")}},clear:function(){for(var e in f.unRender.clear(),l)l[e]=""},update:function(e){var n=e||u;if(m.listTotal(n))for(var r in n){var t=this._template(n[r]);l[r]+=t,f.unRender[r]+=n[r].length}},reset:function(e){this.clear(),this.update(e)}},newsDropdown:{clear:function(){z(".news-item").remove(),z("[data-my-hr]").remove(),f.rendered.clear()},insert:function(){if(f.unRender.total){var e=f.unRender.total&&!f.rendered.total;for(var t in l){var a=l[t],o=z("#".concat(t,"-news-title"));if(a){o.is(":hidden")&&show(o);var s=z("[data-my-hr=".concat(t,"-news-hr]"));s.length?s.last().after(a):o.after(a),f.rendered[t]+=f.unRender[t]}else e&&show(o,!1)}var i=f.db.total-f.rendered.total;show(n,i),show(r,!i),m.htmlStr.clear()}}}}}},s=o.news,i=s.readMoring,l=s.htmlStr,u=s.newsList,d=s.excepts,f=s.num,m=s.fn,p=(0,K.Z)((function(){return v.apply(this,arguments)}),{auto:!0,ms:3e5});function g(){return g=(0,j.Z)(G().mark((function e(n){var r,t;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(confirm("真的要登出?")){e.next=4;break}return alert("對嘛，再待一下嘛"),e.abrupt("return");case 4:return e.next=6,J.Z.get("/api/user/logout");case 6:r=e.sent,t=r.data,alert(t),location.href="/login";case 10:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function v(){return(v=(0,j.Z)(G().mark((function e(){var n,r,a,o,l,u;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.status&&!s.newsDropdownOpen){e.next=2;break}return e.abrupt("return");case 2:return i.status=!0,n=ee({},d),e.next=6,c({excepts:n});case 6:return r=e.sent,a=r.data.news,o=a.hasNews,l=a.newsList,o&&(m.newsList.clear(),m.htmlStr.clear(),m.newsDropdown.clear()),m.newsList.update(a),m.htmlStr.update(l),u=f.db.unconfirm-f.rendered.unconfirm,show(t,u).text(u||""),i.status=!1,console.log("@auto readMore OK..."),e.abrupt("return");case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=(0,j.Z)(G().mark((function e(){var n,r,a,o,s;return G().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.status=!0,n=ee({},d),e.next=4,c({excepts:n});case 4:r=e.sent,a=r.data.news,o=a.newsList,a.hasNews&&(m.newsDropdown.clear(),m.newsList.clear(),m.htmlStr.clear()),m.newsList.update(a),m.htmlStr.update(o),m.newsDropdown.insert(),s=f.db.unconfirm-f.rendered.unconfirm,show(t,s).text(s||""),i.status=!1;case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}m.newsList.reset(e.news),m.htmlStr.update(),show(t,f.db.unconfirm).text(f.db.unconfirm||""),a.on("show.bs.dropdown",(function(){s.newsDropdownOpen=!0})),a.on("hide.bs.dropdown",(function(){s.newsDropdownOpen=!1})),a.click((function(){f.unRender.total&&m.newsDropdown.insert();var e=f.db.unconfirm-f.rendered.unconfirm;show(t,e).text(e||"")})),n.click((function(){return h.apply(this,arguments)})),z("#logout").click((function(e){return g.apply(this,arguments)})),p()},a=function(e){var n,r=F()(n='\n                        <ul class="navbar-nav justify-content-around">\n                            <li class="nav-item">\n                                <a class="nav-link" href="/self">個人頁面</a>\n                            </li>\n                            <li class="nav-item">\n                                <a class="nav-link" href="/album/list?owner_id='.concat(e,'">文章相簿</a>\n                            </li>\n                            <li class="nav-item">\n                                <a class="nav-link" href="/setting?owner_id=')).call(n,e,'">個人設置</a>\n                            </li>\n                            <li class="nav-item">\n                                <a id="logout" class="btn btn-outline-success text-nowrap">登出</a>\n                            </li>\n                        </ul>\n                        ');return z("#needCollapse-list").html(r),z("#noNeedCollapse-list").html('\n                        <li class="nav-item d-none d-sm-inline-block">\n                            <a class="nav-link" href="/square">廣場頁</a>\n                        </li>\n                        \x3c!--純粹用作排版--\x3e\n                        <li style="flex-grow: 1;">\n                        </li> \n                        \x3c!--下拉選單--\x3e\n                        <li class="nav-item dropdown">\n                            <a class="nav-link dropdown-toggle" href="#" id="newsDropdown"\n                                role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">通知\n                                <span class="position-absolute translate-middle badge rounded-pill bg-danger news-count"></span>\n                            </a>\n                            \x3c!-- 通知列表 --\x3e\n                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown" id="newList">\n                                \x3c!-- 新通知標題 --\x3e\n                                <li class="dropdown-item" id="unconfirm-news-title">新通知</li>\n                                \x3c!-- 先前通知的標頭 --\x3e\n                                <li class="dropdown-item" id="confirm-news-title">先前的通知</li>\n                                <li id="readMore">\n                                    <button class="dropdown-item link-primary" type="button">讀取更多</button>\n                                </li>\n                                <li class="dropdown-item" id="noNews">\n                                    <span>沒有更多了</span>\n                                </li>\n                            </ul>\n                        </li>\n                        '),!0},e.next=8,c();case 8:return n=e.sent,r=n.errno,t=n.data,i(),r?s():(a(t.me.id),o(t)),e.abrupt("return",t);case 13:case"end":return e.stop()}}),e)}))),ae.apply(this,arguments)}console.log("@navbar loading...")},67874:(e,n,r)=>{"use strict";r.d(n,{Z:()=>Z});var t,a,o=r(68270),s=r.n(o),i=r(44315),c=r.n(i),l=r(17876),u=r.n(l),d=r(90837),f=r.n(d),m=r(86806),p=r(1005),g=r(58837),v=r.n(g),h=r(74846),w=r.n(h),E=r(66584),R=r.n(E),y=r(21530),b=r.n(y),A=r(38414),x=r.n(A),O=r(59588),I=r.n(O),T=r(17533);function _(e,n){var r=void 0!==c()&&u()(e)||e["@@iterator"];if(!r){if(f()(e)||(r=function(e,n){var r;if(e){if("string"==typeof e)return L(e,n);var t=w()(r=Object.prototype.toString.call(e)).call(r,8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?s()(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?L(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}function L(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}console.log("@validate loading...");var S=new(b())({strict:!1,allErrors:!0,$data:!0});x()(S),I()(S),S.addKeyword({keyword:"isEmailExist",async:!0,type:"string",schemaType:"boolean",validate:function(e,n,r,t){return $.apply(this,arguments)},errors:!0}),S.addKeyword({keyword:"diff",$data:!0,type:["string","number"],schemaType:["string","number","null"],validate:function e(n,r,t,a){if(console.log("@schema => ",n),console.log("@data => ",r),console.log("@parentSchema => ",t),console.log("@dataCtx => ",a),n!==r||!n)return!0;var o=a.instancePath;return e.errors=[{instancePath:o,message:"與原資料相同"}],!1},errors:!0}),S.addKeyword({keyword:"confirmPassword",type:"string",async:!0,schemaType:"boolean",validate:function(e,n,r,t){return N.apply(this,arguments)},errors:!0}),S.addKeyword({keyword:"noSpace",type:"string",schemaType:"boolean",validate:function e(n,r,t,a){if(!n)return!0;if(/\s/g.test(r)){var o=a.instancePath;return e.errors=[{instancePath:o,message:"不可包含空格"}],!1}return!0},errors:!0});var D={URL:"http://my.ajv.schema",VALIDATE:{DEFS:"defs",EMAIL:"email",REGISTER:"register",LOGIN:"login",PASSWORD:"password",AVATAR:"avatar",SETTING:"setting"},API:{EMAIL:"/api/user/isEmailExist",PASSWORD:"/api/user/confirmPassword"}},k=(t={},(0,p.Z)(t,D.VALIDATE.DEFS,{$id:"".concat(D.URL,"/defs.json"),definitions:{email:{type:"string",format:"email",errorMessage:{type:"必須是字符串",format:"必須是電子信箱格式"}},nickname:{type:"string",pattern:"^[\\u4e00-\\u9fa5a-zA-Z\\d]+$",maxLength:20,errorMessage:{type:"必須是字符串",pattern:"必須由英文、數字以及底線組成",maxLength:"長度需小於20個字"}},origin_password:{type:"string",pattern:"^[\\w]+$",minLength:6,maxLength:32,errorMessage:{type:"必須是字符串",pattern:"必須由英文、數字以及底線組成",minLength:"長度須介於6-32個字符",maxLength:"長度須介於6-32個字符"}},password:{type:"string",pattern:"^[\\w]+$",minLength:6,maxLength:32,errorMessage:{type:"必須是字符串",pattern:"必須由英文、數字以及底線組成",minLength:"長度須介於6-32個字符",maxLength:"長度須介於6-32個字符"}},password_again:{type:"string",const:{$data:"1/password"},pattern:"^[\\w]+$",minLength:6,maxLength:32,errorMessage:{type:"必須是字符串",const:"請再次確認密碼是否相同",pattern:"必須由英文、數字以及底線組成",minLength:"長度須介於6-32個字符",maxLength:"長度須介於6-32個字符"}},age:{type:"number",minimum:1,maximum:120,errorMessage:{type:"必須是數字",minimum:"必需介於1-120之間",maximum:"必需介於1-120之間"}},avatar:{type:"string",format:"binary",errorMessage:{type:"必須是string",format:"頭像資料需符合url格式"}},avatar_hash:{type:"string",errorMessage:"avatar_hash必須是字符串"}}}),(0,p.Z)(t,D.VALIDATE.EMAIL,{$id:"".concat(D.URL,"/email.json"),$async:!0,type:"object",if:{properties:{email:{$ref:"defs.json#/definitions/email"}},required:["email"]},then:{properties:{email:{type:"string",isEmailExist:!0}}},else:{$ref:"#/if"},errorMessage:{required:"必填"}}),(0,p.Z)(t,D.VALIDATE.REGISTER,{$id:"".concat(D.URL,"/register.json"),type:"object",properties:{email:{$ref:"defs.json#/definitions/email"},password:{$ref:"defs.json#/definitions/password"},password_again:{$ref:"defs.json#/definitions/password_again"}},required:["email","password","password_again"],errorMessage:{required:"必填"}}),(0,p.Z)(t,D.VALIDATE.LOGIN,{$id:"".concat(D.URL,"/login.json"),type:"object",properties:{email:{$ref:"defs.json#/definitions/email"},password:{$ref:"defs.json#/definitions/password"}},required:["email","password"],errorMessage:{required:"必填"}}),(0,p.Z)(t,D.VALIDATE.PASSWORD,{$id:"".concat(D.URL,"/password.json"),$async:!0,type:"object",if:{properties:{origin_password:{$ref:"defs.json#/definitions/password"}},required:["origin_password"]},then:{properties:{origin_password:{confirmPassword:!0}},required:["origin_password"]},else:{$ref:"#/if"},errorMessage:{required:"必填"}}),(0,p.Z)(t,D.VALIDATE.AVATAR,{$id:"".concat(D.URL,"/avatar.json"),type:"object",properties:{avatar_base64:{format:"byte",errorMessage:{format:"非base64編碼"}},avatar_hash:{diff:{$data:"1/$$me/avatar_hash"},$ref:"defs.json#/definitions/avatar_hash"}},required:["avatar_base64","avatar_hash"],errorMessage:{required:"必填"}}),(0,p.Z)(t,D.VALIDATE.SETTING,{$id:"".concat(D.URL,"/setting.json"),type:"object",allOf:[{minProperties:2,properties:{$$me:{type:"object",errorMessage:{type:"$$me需是object"}},email:{noSpace:!0,diff:{$data:"1/$$me/email"},$ref:"defs.json#/definitions/email"},age:{noSpace:!0,diff:{$data:"1/$$me/age"},$ref:"defs.json#/definitions/age"},nickname:{noSpace:!0,diff:{$data:"1/$$me/nickname"},$ref:"defs.json#/definitions/nickname"},password:{noSpace:!0,diff:{$data:"1/$$me/password"},$ref:"defs.json#/definitions/password"},avatar_hash:{diff:{$data:"1/$$me/avatar_hash"},$ref:"defs.json#/definitions/avatar_hash"}},required:["$$me"],errorMessage:{required:"必需有值",minProperties:"至少需改一筆資料"}},{properties:{password:{$ref:"defs.json#/definitions/password",diff:{$data:"1/$$me/origin_password"}},password_again:{$ref:"defs.json#/definitions/password_again"}},dependentRequired:{password:["password_again","origin_password"],password_again:["password","origin_password"]},errorMessage:{dependentRequired:"必填"}}],errorMessage:{type:"驗證數據必須是 object 格式"}}),t);function M(e){var n=S.compile(k[e]);return function(){var e=(0,m.Z)(R().mark((function e(r){var t,a;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n(r);case 3:if(!n.errors){e.next=7;break}throw(t=new Error).errors=n.errors,t;case 7:return e.abrupt("return",null);case 10:if(e.prev=10,e.t0=e.catch(0),!(a=e.t0.errors)){e.next=17;break}return e.abrupt("return",(o=a,v()(o).call(o,(function(e,n){var r=n.params,t=n.keyword,a=n.instancePath,o=n.message;if(a){var s=w()(a).call(a,1);e.hasOwnProperty(s)?e[s]+=",".concat(o):e[s]=o}else if("errorMessage"===t){var i=r.errors,c=i[0].keyword;if("required"===c||"dependentRequired"===c){var l,u=_(i);try{for(u.s();!(l=u.n()).done;){e[l.value.params.missingProperty]=o}}catch(e){u.e(e)}finally{u.f()}}else"minProperties"===c&&(e.all=o)}return e}),{})));case 17:throw e.t0;case 18:case"end":return e.stop()}var o}),e,null,[[0,10]])})));return function(n){return e.apply(this,arguments)}}()}function N(){return(N=(0,m.Z)(R().mark((function e(n,r,t,a){var o,s,i,c,l,u;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",!0);case 2:return o={origin_password:r},e.next=5,T.Z.post(D.API.PASSWORD,o);case 5:if(s=e.sent,i=s.errno,c=s.msg,!i){e.next=13;break}throw l=a.instancePath,(u=new Error).errors=[{instancePath:l,message:c}],u;case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=(0,m.Z)(R().mark((function e(n,r,t,a){var o,s,i,c,l,u,d;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",!0);case 2:return o="email",e.next=5,T.Z.post("/api/user/isEmailExist",(0,p.Z)({},o,r));case 5:if(s=e.sent,i=s.errno,c=s.msg,!i){e.next=14;break}throw l=a.instancePath,u=new Error,d=c[o],u.errors=[{instancePath:l,message:d}],u;case 14:return e.abrupt("return",!0);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}S.addSchema(k[D.VALIDATE.DEFS]);const Z=(a={},(0,p.Z)(a,D.VALIDATE.EMAIL,M(D.VALIDATE.EMAIL)),(0,p.Z)(a,D.VALIDATE.REGISTER,M(D.VALIDATE.REGISTER)),(0,p.Z)(a,D.VALIDATE.LOGIN,M(D.VALIDATE.LOGIN)),(0,p.Z)(a,D.VALIDATE.PASSWORD,M(D.VALIDATE.PASSWORD)),(0,p.Z)(a,D.VALIDATE.AVATAR,M(D.VALIDATE.AVATAR)),(0,p.Z)(a,D.VALIDATE.SETTING,M(D.VALIDATE.SETTING)),a)}},e=>{e.O(0,[216],(()=>(2779,e(e.s=2779)))),e.O()}]);